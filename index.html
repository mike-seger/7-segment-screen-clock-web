<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">

<!-- Load font definitions from /fonts/fonts.css -->
<link rel="stylesheet" href="fonts/fonts.css">

<style>
    :root {
        --on-color: #00ff5a;
        --bg: #000;

        /* scaling factors for groups */
        --numeric-scale: 1;
        --alpha-scale: 1;
    }

    body {
        background: var(--bg);
        margin: 0;
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
        color: var(--on-color);
        font-family: monospace;
        /* allow the content to extend a bit without harsh clipping */
        overflow: hidden;
    }

    #clock {
        text-align: center;
        overflow: visible;
    }

    #menuButton {
        position: fixed;
        right: 20px;
        top: 20px;
        font-size: 34px;
        cursor: pointer;
        user-select: none;
        color: var(--on-color);
    }

    #menuPanel {
        position: fixed;
        right: 20px;
        top: 70px;
        background: #111;
        border: 1px solid #333;
        padding: 10px 12px;
        color: var(--on-color);
        font-size: 12px;
        font-family: system-ui, sans-serif;
        display: none;
        max-width: 260px;
        z-index: 10;
    }

    #menuPanel label {
        font-size: 11px;
    }

    #menuPanel select,
    #menuPanel input[type="range"],
    #menuPanel input[type="color"] {
        width: 100%;
        margin: 4px 0 8px;
        background: #000;
        color: var(--on-color);
        border: 1px solid #333;
    }

    #menuPanel input[type="range"] {
        accent-color: var(--on-color);
    }

    #menuPanel input[type="color"] {
        padding: 0;
        border-radius: 2px;
        height: 22px;
    }

    .section-title {
        font-weight: bold;
        margin-top: 4px;
        margin-bottom: 4px;
        font-size: 12px;
        border-bottom: 1px solid #333;
        padding-bottom: 2px;
    }

    .subsection-title {
        font-weight: 600;
        margin-top: 6px;
        margin-bottom: 2px;
        font-size: 11px;
    }

    .inline-label {
        display: flex;
        justify-content: space-between;
        align-items: center;
        gap: 6px;
    }

    #date {
        font-size: 4vmin;
        margin-bottom: 4vmin;
        line-height: 1.1;
        padding: 0.2em 0;
    }

    #time {
        font-size: 25vmin;
        white-space: nowrap;
        line-height: 1.1;
        padding: 0.2em 0;
    }

    #sec {
        font-size: 11vmin;
        padding-left: 2vmin;
    }

    /* group wrappers for scaling */
    .numeric-group,
    .alpha-group {
        display: inline-block;
        transform-origin: center center;
    }

    .numeric-group {
        transform: scale(var(--numeric-scale));
    }

    .alpha-group {
        transform: scale(var(--alpha-scale));
    }

    .spacer {
        display: inline-block;
        width: 0.7em;
    }
</style>
</head>

<body>

<div id="menuButton">â‰¡</div>

<div id="menuPanel">
    <div class="section">
        <div class="section-title">Fonts</div>
        <label for="numericFontSelect">Numeric (time, day, year)</label>
        <select id="numericFontSelect"></select>

        <label for="alphaFontSelect">Alphabetic (weekday, month)</label>
        <select id="alphaFontSelect"></select>
    </div>

    <div class="section">
        <div class="section-title">Group scale</div>

        <div class="subsection">
            <div class="subsection-title">Numeric group</div>
            <div class="inline-label">
                <span>Scale</span>
                <span id="numericScaleLabel">100%</span>
            </div>
            <input type="range" id="numericScale" min="50" max="200" step="1" value="100">
        </div>

        <div class="subsection">
            <div class="subsection-title">Alphabetic group</div>
            <div class="inline-label">
                <span>Scale</span>
                <span id="alphaScaleLabel">100%</span>
            </div>
            <input type="range" id="alphaScale" min="50" max="200" step="1" value="100">
        </div>
    </div>

    <div class="section">
        <div class="section-title">Lines & seconds</div>

        <div class="subsection">
            <div class="subsection-title">Date line</div>
            <label>Color</label>
            <input type="color" id="dateColor">
            <div class="inline-label">
                <span>Font size</span>
                <span id="dateFontSizeLabel"></span>
            </div>
            <input type="range" id="dateFontSize" min="1" max="400" step="1">
        </div>

        <div class="subsection">
            <div class="subsection-title">Time line</div>
            <label>Color</label>
            <input type="color" id="timeColor">
            <div class="inline-label">
                <span>Font size</span>
                <span id="timeFontSizeLabel"></span>
            </div>
            <input type="range" id="timeFontSize" min="1" max="400" step="1">
        </div>

        <div class="subsection">
            <div class="subsection-title">Seconds</div>
            <label>Color</label>
            <input type="color" id="secColor">
            <div class="inline-label">
                <span>Font size</span>
                <span id="secFontSizeLabel"></span>
            </div>
            <input type="range" id="secFontSize" min="1" max="400" step="1">
        </div>
    </div>
</div>

<div id="clock">
    <div id="date">
        <span id="weekday" class="alpha-group"></span>
        <span class="spacer"></span>
        <span id="dayNum" class="numeric-group"></span>
        <span class="spacer"></span>
        <span id="monthName" class="alpha-group"></span>
        <span class="spacer"></span>
        <span id="yearNum" class="numeric-group"></span>
    </div>

    <div id="time">
        <span id="main" class="numeric-group"></span>
        <span id="sec" class="numeric-group"></span>
    </div>
</div>

<script>
// ---- TIME UPDATE ----
function updateClock() {
    const now = new Date();
    const h = String(now.getHours()).padStart(2,"0");
    const m = String(now.getMinutes()).padStart(2,"0");
    const s = String(now.getSeconds()).padStart(2,"0");

    document.getElementById("main").textContent = `${h}:${m}`;
    document.getElementById("sec").textContent  = `:${s}`;

    const days  = ["SUN","MON","TUE","WED","THU","FRI","SAT"];
    const months= ["JAN","FEB","MAR","APR","MAY","JUN","JUL","AUG","SEP","OCT","NOV","DEC"];

    document.getElementById("weekday").textContent  = days[now.getDay()];
    document.getElementById("dayNum").textContent   = String(now.getDate()).padStart(2,"0");
    document.getElementById("monthName").textContent= months[now.getMonth()];
    document.getElementById("yearNum").textContent  = now.getFullYear();
}
setInterval(updateClock, 250);
updateClock();


// ---- MENU TOGGLE ----
document.getElementById("menuButton").onclick = () => {
    const p = document.getElementById("menuPanel");
    p.style.display = (p.style.display === "block" ? "none" : "block");
};


// ---- DYNAMIC FONT DISCOVERY ----
// Load fonts.css as text and extract each font-family:
fetch("fonts/fonts.css")
    .then(r => r.text())
    .then(cssText => {
        const fontFamilies = Array.from(cssText.matchAll(/font-family:\s*["']([^"']+)["']/g))
                                  .map(m => m[1]);
        populateFontMenu(fontFamilies);
    });

function populateFontMenu(list) {
    const numericSelect = document.getElementById("numericFontSelect");
    const alphaSelect   = document.getElementById("alphaFontSelect");

    numericSelect.innerHTML = "";
    alphaSelect.innerHTML   = "";

    list.forEach(font => {
        const makeOpt = () => {
            const opt = document.createElement("option");
            opt.value = font;
            opt.textContent = font;
            return opt;
        };
        numericSelect.appendChild(makeOpt());
        alphaSelect.appendChild(makeOpt());
    });

    const applyNumericFont = () => {
        document.querySelectorAll(".numeric-group").forEach(el => {
            el.style.fontFamily = `"${numericSelect.value}", monospace`;
        });
    };
    const applyAlphaFont = () => {
        document.querySelectorAll(".alpha-group").forEach(el => {
            el.style.fontFamily = `"${alphaSelect.value}", monospace`;
        });
    };

    numericSelect.onchange = applyNumericFont;
    alphaSelect.onchange   = applyAlphaFont;

    // Initial defaults: use first font if available
    if (list.length > 0) {
        numericSelect.value = list[0];
        alphaSelect.value   = list[0];
    }
    applyNumericFont();
    applyAlphaFont();
}


// ---- SCALE CONTROLS ----
const numericScaleSlider = document.getElementById("numericScale");
const alphaScaleSlider   = document.getElementById("alphaScale");
const numericScaleLabel  = document.getElementById("numericScaleLabel");
const alphaScaleLabel    = document.getElementById("alphaScaleLabel");

function applyNumericScale(v) {
    const s = v / 100;
    document.documentElement.style.setProperty("--numeric-scale", s);
    numericScaleLabel.textContent = `${v}%`;
}
function applyAlphaScale(v) {
    const s = v / 100;
    document.documentElement.style.setProperty("--alpha-scale", s);
    alphaScaleLabel.textContent = `${v}%`;
}

numericScaleSlider.addEventListener("input", e => applyNumericScale(e.target.value));
alphaScaleSlider.addEventListener("input",  e => applyAlphaScale(e.target.value));

// init
applyNumericScale(numericScaleSlider.value);
applyAlphaScale(alphaScaleSlider.value);


// ---- LINE & SECONDS STYLE CONTROLS ----
function rgbToHex(rgb) {
    const m = rgb.match(/rgba?\((\d+),\s*(\d+),\s*(\d+)/);
    if (!m) return "#00ff5a";
    return "#" + [m[1], m[2], m[3]].map(x => {
        const n = parseInt(x, 10);
        return n.toString(16).padStart(2, "0");
    }).join("");
}

function initLineStyleControls() {
    const dateEl = document.getElementById("date");
    const timeEl = document.getElementById("time");
    const secEl  = document.getElementById("sec");

    const dateColorInput = document.getElementById("dateColor");
    const timeColorInput = document.getElementById("timeColor");
    const secColorInput  = document.getElementById("secColor");

    const dateSizeSlider = document.getElementById("dateFontSize");
    const timeSizeSlider = document.getElementById("timeFontSize");
    const secSizeSlider  = document.getElementById("secFontSize");

    const dateSizeLabel = document.getElementById("dateFontSizeLabel");
    const timeSizeLabel = document.getElementById("timeFontSizeLabel");
    const secSizeLabel  = document.getElementById("secFontSizeLabel");

    // DATE
    if (dateEl) {
        const cs = getComputedStyle(dateEl);
        dateColorInput.value = rgbToHex(cs.color);
        const px = parseFloat(cs.fontSize) || 16;
        dateSizeSlider.value = Math.round(px);
        dateSizeLabel.textContent = `${Math.round(px)}px`;

        dateColorInput.addEventListener("input", e => {
            dateEl.style.color = e.target.value;
        });
        dateSizeSlider.addEventListener("input", e => {
            const v = e.target.value;
            dateEl.style.fontSize = `${v}px`;
            dateSizeLabel.textContent = `${v}px`;
        });
    }

    // TIME (HH:MM + seconds inherit unless overridden)
    if (timeEl) {
        const cs = getComputedStyle(timeEl);
        timeColorInput.value = rgbToHex(cs.color);
        const px = parseFloat(cs.fontSize) || 80;
        timeSizeSlider.value = Math.round(px);
        timeSizeLabel.textContent = `${Math.round(px)}px`;

        timeColorInput.addEventListener("input", e => {
            timeEl.style.color = e.target.value;
        });
        timeSizeSlider.addEventListener("input", e => {
            const v = e.target.value;
            timeEl.style.fontSize = `${v}px`;
            timeSizeLabel.textContent = `${v}px`;
        });
    }

    // SECONDS (override if desired)
    if (secEl) {
        const csSec = getComputedStyle(secEl);
        secColorInput.value = rgbToHex(csSec.color);
        const pxSec = parseFloat(csSec.fontSize) || 40;
        secSizeSlider.value = Math.round(pxSec);
        secSizeLabel.textContent = `${Math.round(pxSec)}px`;

        secColorInput.addEventListener("input", e => {
            secEl.style.color = e.target.value;
        });
        secSizeSlider.addEventListener("input", e => {
            const v = e.target.value;
            secEl.style.fontSize = `${v}px`;
            secSizeLabel.textContent = `${v}px`;
        });
    }
}

initLineStyleControls();
</script>
</body>
</html>
